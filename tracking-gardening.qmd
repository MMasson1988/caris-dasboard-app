---
title: "PROGRAMME JARDINAGE"
subtitle: "Caris Foundation | Tracking des bénéficiaires"
author: "M&E Department"
date: "`r format(Sys.time(), '%d %B %Y')`"
format:
  html:
    theme: flatly
    css:
      - styles.css
    fig-align: center
    page-layout: article
    toc: true
    toc-location: left           # Pour bien positionner la TOC à gauche
    toc-depth: 2                 # Ajuste la profondeur de la TOC selon tes titres
    number-sections: true
    self-contained: true
---
<style>

  /* Applique au titre de niveau 1 à 3 */
  h2, h3 {
    color: #003366;                             /* Bleu foncé pour les titres */
    border-bottom: 2px solid #0055a5;           /* Ligne décorative sous les titres */
    padding-bottom: 0.3em;                      /* Espace entre le titre et la ligne */
  }

  /* Applique aux en-têtes de colonne */
  th {
    background-color: #003366;                  /* Fond bleu foncé */
    color: #fff;                                /* Texte blanc */
    text-align: left;                           /* Alignement à gauche */
    padding: 12px;                              /* Espace interne */
  }

  /* Applique aux cellules du tableau */
  td {
    padding: 10px;                              /* Espace interne */
    border-top: 1px solid #ddd;                 /* Ligne de séparation entre lignes */
  }

  /* Applique une couleur de fond alternée à une ligne sur deux */
  tr:nth-child(even) {
    background-color: #f9f9f9;                  /* Fond gris très clair */
  }

  /* Style pour les cartes ("cards") visuelles */
  .card {
    background: white;                          /* Fond blanc */
    border: 1px solid #ddd;                     /* Bordure grise claire */
    border-radius: 10px;                        /* Coins arrondis */
    padding: 1.5rem;                            /* Espace interne généreux */
    margin-bottom: 2rem;                        /* Espace entre les cartes */
    box-shadow: 0 2px 6px rgba(0,0,0,0.1);       /* Ombre portée discrète */
  }
</style>


```{r setup, include=FALSE}
knitr::opts_chunk$set(warning = FALSE, message = FALSE)
```


```{r libraries, echo=FALSE,warning = FALSE, message = FALSE}
Sys.setenv(TZ='GMT')
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(RMySQL))
suppressPackageStartupMessages(library(odbc))
suppressPackageStartupMessages(library(DBI))
suppressPackageStartupMessages(library(viridis))
suppressPackageStartupMessages(library(ggplot2))
suppressPackageStartupMessages(library(ggrepel))
suppressPackageStartupMessages(library(hrbrthemes))
suppressPackageStartupMessages(library(plotly))
suppressPackageStartupMessages(library(stringr))
suppressPackageStartupMessages(library(RColorBrewer))
suppressPackageStartupMessages(library(tidytext))
suppressPackageStartupMessages(library(dplyr))
suppressPackageStartupMessages(library(purrr))
suppressPackageStartupMessages(library(lubridate))
suppressPackageStartupMessages(library(tidyr))
suppressPackageStartupMessages(library(scales))
suppressPackageStartupMessages(library(extrafont))
suppressPackageStartupMessages(library(forcats))
suppressPackageStartupMessages(library(DT))
suppressPackageStartupMessages(library(data.table))
suppressPackageStartupMessages(library(readxl))
suppressPackageStartupMessages(library(writexl))
suppressPackageStartupMessages(library(reticulate))
```

```{r, echo=FALSE}
reticulate::use_virtualenv("C:/Users/moise/Downloads/caris-dashboard-app/.venv", required = TRUE)

#use_virtualenv("./../../python_env", required = TRUE)
```

```{python, echo=FALSE, results='hide', warning=FALSE, message=FALSE}
#Import relevant libraries
import os
import re
import time
import warnings
from datetime import datetime, timedelta
from dateutil.relativedelta import relativedelta
from dateutil.parser import parse

# Third-party imports
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import seaborn as sns
import plotly.express as px
import plotly.graph_objects as go
from itables import show, init_notebook_mode, options
from IPython.display import display, HTML
import openpyxl
import xlsxwriter
import pymysql
from sqlalchemy import create_engine
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.chrome.options import Options
from webdriver_manager.chrome import ChromeDriverManager
from dotenv import load_dotenv
from IPython.core.interactiveshell import InteractiveShell
from IPython.display import display
# Load environment variables from .env file
load_dotenv('.env')
pd.set_option('display.float_format', '{:.2f}'.format)  # Set float format

# Suppress warnings
warnings.filterwarnings('ignore')

# Enable interactive shell for Jupyter Notebook
_ = InteractiveShell.ast_node_interactivity = "all"
```

... (rest of file unchanged)